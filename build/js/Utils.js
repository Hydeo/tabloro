"use strict";function slice(t,n,r){switch(arguments.length){case 0:throw"no args";case 1:return slice(t,0,t.length);case 2:return slice(t,n,t.length);default:for(var e=Math.max(0,r-n),i=new Array(e),o=-1;++o<e;)i[o]=t[n+o];return i}}function random(t,n){if(void 0===n)throw new Error("random end must be defined");var r=Math.floor(Math.random()*(n-t+1));return r+=t}function isFunction(t){var n={};return t&&"[object Function]"===n.toString.call(t)}function maybeFun(t){return isFunction(t)?t():void 0}function maybe(t){return function(n){return n?t(n):!1}}function dynamicInvoke(t){return function(n){return n[t](n)}}function randomFrom(t){var n=random(0,t.length-1);return t[n]}function chance(t,n){random(0,100)<t&&n()}function double(t){return 2*t}function randomDirection(){var t=1===random(0,2)?"+":"-";return t}function numberWithCommas(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}var Utils={humanize:function(t,n,r){return R.align(ifLte,R.interpolate(t,n,r.length),r)},alignPosition:function(t,n){t&&n&&(t.x=n.x,t.y=n.y)},alignPosRot:function(t,n){t&&n&&(t.x=n.x,t.y=n.y,t.rotation=n.rotation)},toCorner:function(t,n){t&&n&&(t.x=n.x-n.width/2,t.y=n.y-n.height/2)},childTo:function(t,n){return function(r,e){r&&e&&(r.x=e.width*t,r.y=e.height*n)}},aboveCorner:R.curry(function(t,n){return n&&t&&(n.x=t.x-t.width/2,n.y=t.y-t.height/2-n.height),n}),delta:function(t,n){return{x:t.x-n.x,y:t.y-n.y}},shuffle:function(t){for(var n=t.length-1;n>0;n--){var r=Math.floor(Math.random()*(n+1)),e=t[n];t[n]=t[r],t[r]=e}return t},printargs:function(){return arguments[0]},buttonize:function(t,n){return t.interactive=!0,t.buttonMode=!0,t.defaultCursor="pointer",t.click=t.tap=n,t},angle:function(t){return Math.atan2(t.y,t.x)},angle2points:function(t,n){return R.compose(Utils.angle,Utils.delta)(t,n)},rad2Deg:function(t){var n=180*t/Math.PI;return 0>n&&(n+=360),n},addProperties:function(t,n){return R.forEach(function(r){t[r]=n[r]})(R.keys(n)),t},rotate90:function(t){return t+Math.PI/2},removeFromArray:R.curry(function(t,n){return n&&n.length>0&&n.splice(n.indexOf(t),1),t}),removeChildren:function(t){R.times(function(){t.children.length&&t.getChildAt(0)&&t.removeChild(t.getChildAt(0))},t.children.length)},move:function(t){var n,r,e=t.rotation,i=t.speed;return n=Math.cos(e)*i,r=Math.sin(e)*i,t.position.set(t.x+n,t.y+r),t},center:function(t,n){t.x=n.x+(n.width-t.width)/2,t.y=n.y+(n.height-t.height)/2},testHitArray:function(t,n){return function(r){for(var e=n.length-1;e>=0;e-=1)Utils.testHit(r,n[e],t);return r}},testHit:function(t,n,r){Utils.collidesRectCircle(t,n)&&r(t,n)},testNearMissArray:function(t,n){return function(r){for(var e=n.length-1;e>=0;e-=1)Utils.testNearMiss(r,n[e],t);return r}},testNearMiss:function(t,n,r){Utils.collidesRectCircle(t,n,n.nearMissRadius)&&r(n)},pointIntersection:function(t,n){return t.x>n.x&&t.x<n.x+n.width&&t.y>n.y&&t.y<n.y+n.height},simpleIntersection:function(t,n){return!(n.x>t.x+t.width||n.x+n.width<t.x||n.y>t.y+t.height||n.y+n.height<t.y)},getPowDistance:function(t,n,r,e){var i=Math.abs(t-r),o=Math.abs(n-e);return i*i+o*o},collidesRectCircle:function(t,n,r){var e=r||.5*n.width,i=.75*Math.max(t.width,t.height);if(Math.abs(n.x-t.x)<e+i&&Math.abs(n.y-t.y)<e+i){var o,a,u=t.rotation>0?-1*t.rotation:-1*t.rotation+Math.PI,c=Math.cos(u)*(n.x-t.x)-Math.sin(u)*(n.y-t.y)+t.x,h=Math.sin(u)*(n.x-t.x)+Math.cos(u)*(n.y-t.y)+t.y,s=t.x-.5*t.width,f=t.y-.5*t.height;o=s>c?s:c>s+t.width?s+t.width:c,a=f>h?f:h>f+t.height?f+t.height:h;var l=this.getPowDistance(c,h,o,a);if(e*e>l)return!0}return!1},doPolygonsIntersect:function(t,n){var r,e,i,o,a,u,c,h,s=[t,n];for(o=0;o<s.length;o++){var f=s[o];for(a=0;a<f.length;a++){var l=(a+1)%f.length,d=f[a],y=f[l],g={x:y.y-d.y,y:d.x-y.x};for(r=e=void 0,u=0;u<t.length;u++)i=g.x*t[u].x+g.y*t[u].y,(isUndefined(r)||r>i)&&(r=i),(isUndefined(e)||i>e)&&(e=i);for(c=h=void 0,u=0;u<n.length;u++)i=g.x*n[u].x+g.y*n[u].y,(isUndefined(c)||c>i)&&(c=i),(isUndefined(h)||i>h)&&(h=i);if(c>e||r>h)return CONSOLE("polygons don't intersect!"),!1}}return!0}};